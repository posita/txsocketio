#-*-mode: ini; encoding: utf-8-*-

#=========================================================================
# Copyright (c) 2015 Matt Bogosian <mtb19@columbia.edu>.
#
# Please see the accompanying LICENSE (or LICENSE.txt) file for rights and
# restrictions governing use of this software. All rights not expressly
# waived or licensed are reserved. If such a file did not accompany this
# software, then please contact the author before viewing or using this
# software in any capacity.
#=========================================================================

[tox] #-------------------------------------------------------------------

envlist = reset,py27,py33,py34,pypy,check
skip_missing_interpreters = True

[testenv] #---------------------------------------------------------------

commands =
    coverage run --append -m unittest {posargs:discover}

deps =
    coverage

passenv =
    COVERAGE_PROCESS_START
    _TXSOCKETIO_LOG_LVL

setenv =
    PYTHONWARNINGS = all

[testenv:check] #---------------------------------------------------------

basepython = python

commands =
    coverage report
    coverage html
    python setup.py check -m -r -s -v
    sphinx-build -b html -d docs/_build/doctrees docs docs/_build/html

deps =
    coverage
    sphinx

usedevelop = True

[testenv:dev] #-----------------------------------------------------------

commands =
envdir = .venv-dev
usedevelop = True

[testenv:reset] #---------------------------------------------------------

basepython = python

commands =
    coverage erase
    rm -frv tests/node/node_modules
    sh -c 'cd tests/node && npm install'

skip_install = true

whitelist_externals =
    rm
    sh
